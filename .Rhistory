shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
setwd("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC")
library(Seurat)
library(Matrix)
devtools::install_github('satijalab/seurat-data')
library(SeuratData)
library(patchwork)
library(dplyr)
luad_combined_4_NAMED <- readRDS("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC/Data/luad_combined_4_NAMED.rds")
subset2 <- subset(luad_combined_4_NAMED, idents = c("Malignant","Alveolar cell"))
Idents(subset2) <- subset2$orig.ident
saveRDS(subset2, "subset2.rds")
subsetpaciente4 <- subset(subset2, idents = c("4"))
View(subsetpaciente4@meta.data)
subset2<- readRDS("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC/Data/subset2.rds")
View(subset2)
View(subset2@meta.data)
View(subsetpaciente4)
View(subsetpaciente4@meta.data)
DEGSindividuais<-function(idents){
subsetpaciente <- subset(subset2, idents = c(idents))
print(subsetpaciente@meta.data)
Idents(subsetpaciente) <- subsetpaciente$cell_types
DEGTumorpaciente<-FindMarkers(subsetpaciente, ident.1 = "Malignant", ident.2 = "Alveolar cell", verbose = FALSE )
write.csv(DEGTumorpaciente, file = paste("DEGS_PACIENTE_", idents, ".csv" , sep = ""))
print(DEGTumorpaciente)
degs_significativospaciente<-DEGTumorpaciente %>% filter(DEGTumorpaciente$p_val_adj<0.05)
write.csv(degs_significativospaciente, file = paste("2DEGS_SIGNIFICATIVOS_PACIENTE_", idents,".csv" , sep = ""))
return(degs_significativospaciente)
}
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteA4<-DEGSindividuais("4")
subsetpA4<-subset(subset2, orig.ident = c("4"))
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteA3<-DEGSindividuais("3")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteA3<-DEGSindividuais("6")
subsetpA4<-subset(subset2, orig.ident = c("6"))
View(pacienteA4)
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteA3<-DEGSindividuais("3")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteA6<-DEGSindividuais("6")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteP0006<-DEGSindividuais("P0006")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteP0008<-DEGSindividuais("P0008")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteP0019<-DEGSindividuais("P0019")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteP0020<-DEGSindividuais("P0020")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteP0028<-DEGSindividuais("P0028")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteP0025<-DEGSindividuais("P0025")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteP0030<-DEGSindividuais("P0030")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteP0031<-DEGSindividuais("P0031")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteP0034<-DEGSindividuais("P0034")
subsetpP0018<-subset(subset2, orig.ident = c("P0018"))
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN05<-DEGSindividuais("SSN05")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN10<-DEGSindividuais("SSN10")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN11<-DEGSindividuais("SSN11")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN21<-DEGSindividuais("SSN21")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN22<-DEGSindividuais("SSN22")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN24<-DEGSindividuais("SSN24")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN25<-DEGSindividuais("SSN25")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN27<-DEGSindividuais("SSN27")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN28<-DEGSindividuais("SSN28")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN29<-DEGSindividuais("SSN29")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN30<-DEGSindividuais("SSN30")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN31<-DEGSindividuais("SSN31")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN33<-DEGSindividuais("SSN33")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteRU653<-DEGSindividuais("RU653")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteRU661<-DEGSindividuais("RU661")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteRU675Tum<-DEGSindividuais("RU675Tum")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteRU684Tum<-DEGSindividuais("RU684Tum")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN09<-DEGSindividuais("SSN09")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN12<-DEGSindividuais("SSN12")
#antes estava cell_type mudei para ver o que vira e tamb[em era s[o alveolar mas parece que estamos na mesmo]]
pacienteSSN19<-DEGSindividuais("SSN19")
setwd("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC")
# Carregar os dados do arquivo CSV
deg_data <- read.csv("DEGS_SIGNIFICATIVOS_PACIENTE_A3.csv")
# Carregar os dados do arquivo CSV
deg_data <- read.csv("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC/Tables/Vaidas/Amostra_A3 (1)/DEGS_SIGNIFICATIVOS_PACIENTE_A3")
# Carregar os dados do arquivo CSV
deg_data <- read.csv("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC/Tables/Vaidas/Amostra_A3/DEGS_SIGNIFICATIVOS_PACIENTE_A3")
setwd("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC/Tables/Validas/Amostra_A3 (1)")
setwd("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC")
# Carregar os dados do arquivo CSV
deg_data <- read.csv("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC/Tables/Vaidas/Amostra_A3/DEGS_SIGNIFICATIVOS_PACIENTE_A3.csv")
# Carregar os dados do arquivo CSV
deg_data <- read.csv("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC/Tables/Vaidas/Amostra_A3 (1)/DEGS_SIGNIFICATIVOS_PACIENTE_A3.csv")
setwd("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC/Tables/Validas/Amostra_A3 (1)")
# Carregar os dados do arquivo CSV
deg_data <- read.csv("DEGS_SIGNIFICATIVOS_PACIENTE_A3.csv")
# Carregar os dados do arquivo CSV
deg_data <- read.csv("DEGS_SIGNIFICATIVOS_PACIENTE_A3.csv")
View(deg_data)
# Adicionar coluna de regula??o (up ou down)
deg_data <- deg_data %>%
mutate(
regulation = case_when(
avg_log2FC > 0 ~ "up",
avg_log2FC < 0 ~ "down",
TRUE ~ NA_character_ # Atribuir NA para valores que n?o atendem ?s condi??es
)
)
# Adicionar coluna de dist?ncia de Manhattan e ordenar os dados
deg_data <- deg_data %>%
mutate(
# Calcular a dist?ncia de Manhattan somente para valores v?lidos de p_val_adj
manhattan_distance = case_when(
p_val_adj > 0 ~ abs(avg_log2FC) + abs(-log10(p_val_adj)),
TRUE ~ NA_real_ # Atribuir NA para valores inv?lidos
)
) %>%
arrange(manhattan_distance)
# Salvar os dados atualizados em um novo arquivo CSV
write.csv(deg_data, "DEGS_SIGNIFICATIVOS_PACIENTE_A3", row.names = FALSE)
# Salvar os dados atualizados em um novo arquivo CSV
write.csv(deg_data, "DEGS_SIGNIFICATIVOS_PACIENTE_A3.csv", row.names = FALSE)
setwd("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC/Tables/Validas/Amostra_A4 (1)")
# Carregar os dados do arquivo CSV
deg_data <- read.csv("DEGS_SIGNIFICATIVOS_PACIENTE_A4.csv")
# Adicionar coluna de regula??o (up ou down)
deg_data <- deg_data %>%
mutate(
regulation = case_when(
avg_log2FC > 0 ~ "up",
avg_log2FC < 0 ~ "down",
TRUE ~ NA_character_ # Atribuir NA para valores que n?o atendem ?s condi??es
)
)
# Adicionar coluna de dist?ncia de Manhattan e ordenar os dados
deg_data <- deg_data %>%
mutate(
# Calcular a dist?ncia de Manhattan somente para valores v?lidos de p_val_adj
manhattan_distance = case_when(
p_val_adj > 0 ~ abs(avg_log2FC) + abs(-log10(p_val_adj)),
TRUE ~ NA_real_ # Atribuir NA para valores inv?lidos
)
) %>%
arrange(manhattan_distance)
# Salvar os dados atualizados em um novo arquivo CSV
write.csv(deg_data, "DEGS_SIGNIFICATIVOS_PACIENTE_A4.csv", row.names = FALSE)
setwd("~/mateus.diniz@unesp.br - Google Drive/Drives compartilhados/Mateus - IC/Tables/Validas/Amostra_A6 (1)")
# Carregar os dados do arquivo CSV
deg_data <- read.csv("DEGS_SIGNIFICATIVOS_PACIENTE_A6.csv")
# Adicionar coluna de regula??o (up ou down)
deg_data <- deg_data %>%
mutate(
regulation = case_when(
avg_log2FC > 0 ~ "up",
avg_log2FC < 0 ~ "down",
TRUE ~ NA_character_ # Atribuir NA para valores que n?o atendem ?s condi??es
)
)
# Adicionar coluna de dist?ncia de Manhattan e ordenar os dados
deg_data <- deg_data %>%
mutate(
# Calcular a dist?ncia de Manhattan somente para valores v?lidos de p_val_adj
manhattan_distance = case_when(
p_val_adj > 0 ~ abs(avg_log2FC) + abs(-log10(p_val_adj)),
TRUE ~ NA_real_ # Atribuir NA para valores inv?lidos
)
) %>%
arrange(manhattan_distance)
# Salvar os dados atualizados em um novo arquivo CSV
write.csv(deg_data, "DEGS_SIGNIFICATIVOS_PACIENTE_A6.csv", row.names = FALSE)
View(deg_data)
